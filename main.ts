let MineSpriteKind = SpriteKind.create()
scene.onHitWall(SpriteKind.Projectile, function on_hit_wall(sprite3: Sprite, location: tiles.Location) {
    sprite3.destroy()
})
sprites.onOverlap(SpriteKind.Player, MineSpriteKind, function on_on_overlap(sprite: Sprite, mine: Sprite) {
    
    hp = hp - 10
    if (hp == 0) {
        game.over(false)
    }
    
    statusbar.value = hp
    mine.destroy()
})
//  landmine
function spawn_landmine() {
    
    landmine = sprites.create(img`
            . . . . . . . . . . . . 
                    . . . 6 6 6 6 6 6 . . . 
                    . . 6 6 6 6 6 6 6 6 . . 
                    . 6 6 6 6 6 6 6 6 6 6 . 
                    . 6 6 6 6 6 6 2 6 6 6 . 
                    . 6 6 6 6 f f 6 6 6 6 . 
                    . 6 6 6 f f f f 6 6 6 . 
                    . 6 6 6 6 f f 6 6 6 6 . 
                    . 6 6 6 6 6 6 6 6 6 6 . 
                    . . 6 6 6 6 6 6 6 6 . . 
                    . . . 6 6 6 6 6 6 . . . 
                    . . . . . . . . . . . .
        `, MineSpriteKind)
    landmine.setPosition(randint(16, 144), randint(16, 496))
}

sprites.onOverlap(SpriteKind.Player, SpriteKind.Projectile, function on_on_overlap2(sprite2: Sprite, bullet: Sprite) {
    
    hp = hp - 20
    statusbar.value = hp
    if (hp == 0) {
        game.over(false)
    }
    
    bullet.destroy()
})
let rightBullet : Sprite = null
let leftBullet : Sprite = null
let landmine : Sprite = null
let statusbar : StatusBarSprite = null
let hp = 0
let battleScene = tilemap`
    level1
`
let introScene = tilemap` `
let currentScene = "Intro"
function change_Scene(sceneName: string) {
    if (sceneName == "Intro") {
        tiles.setCurrentTilemap(introScene)
    } else {
        tiles.setCurrentTilemap(battleScene)
    }
    
}

change_Scene("Intro")
scene.setBackgroundImage(img`
    ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ............................fffffffffffffffffffff...............................................................................................................
        ..........................fffffffffffffffffffffffff.............................................................................................................
        ........................ffffffffffffffffffffffffffff............................................................................................................
        ......................ffffffff.................ffffff...........................................................................................................
        .....................fffffff.....................fffff..........................................................................................................
        ....................ffffff........................ffff...............................................................ffffffff...................................
        ...................fffff...........................ffff.........................................................fffffffffffffff.................................
        ..................fffff............................fffff......................................................fffffffffffffffffff...............................
        .................fffff..............................fffff....................................................ffffffffff....ffffffff.............................
        .................ffff....ffff........................fffff..................................................ffffff...........fffffff............................
        ................ffff.....ffff.............fff.........fffff................................................fffff...............fffff............................
        ...............fffff.....fffff...........ffff..........ffff................................................ffff..................ffff...........................
        ...............ffff.......fffff........ffffff...........fff...............................................ffff...................fffff..........................
        ...............fff.........ffffff....fffffff............fff..............................................fffff....................fffff.........................
        ...............ffff.........ffffff.ffffffff.............fff..............................................ffff......................ffff.........................
        ...............ffff..........ffffffffffff...............fff..............................................fff........................fff.........................
        ................fff............ffffffff.................ffff............................................ffff........................ffff........................
        ................fff.............fffff...................ffff............................................ffff........................ffff........................
        ................fff......................................fff............................................fff.....fff..fff.............fff........................
        ................fff......................................fff...........................................ffff.....ffffffff.............ffff.......................
        ................fff........fff.......fff.................fff...........................................ffff.....ffffffff....ffff.....ffff.......................
        ................fff........fff.......fff.................fff...........................................fff.......ffffff.....ffff.ffff.fff.......................
        ................fff........fff.......fff.................fff...........................................fff.......fffffff....fffffffff.fff.......................
        ................fff......................................fff........................................bbbbbbb......fffffff.....ffffffff.fff.......................
        ................fff......................fff.............fff........................................bbbbbbb......fff.fff.....fffffff..fff.......................
        ................fff.....................ffff............ffff........................................bbbbbbb..................fffffff..fff.......................
        ................fff.........fff.......ffffff............ffff...........................................fff...................fffffff..fff.......................
        ................ffff........fffffffffffffff............ffff............................................ffff..................fff......fff.......................
        ................fffff.......ffffffffffffff.............ffff............................................fffff..........................fff.......................
        .................fffff.......fffffffffff..............ffff..fffffffffffffffffffffffffffff...............fffff.........................fff.......................
        ..................ffff................................ffff..fffffffffffffffffffffffffffff................ffff......fffff.............ffff.......................
        ...................ffff..............................ffff..ffffffffffffffffffffffffffffff.................ffff.....ffffffff..........ffff.......................
        ...................fffff............................fffff..ffff.......................fff.................fffff....ffffffffff........fff........................
        ....................fffff..........................fffff...fff........................fff..................fffff......fffffff........fff........................
        .....................fffff........................fffff....fff.................ffffffffff...................fffff........ffff.......ffff........................
        ......................ffff.......................fffff.....fff.......ffffffffffffffffffff....................ffff...................ffff........................
        .......................ffffff...............fffffffff......fff.....ffffffffffffffffffffff.....................fffff................ffff.........................
        .......................ffffffffff.ffffffffffffffffff.......fff.....ffffffffffffff.............................fffffff............ffffff.........................
        ........................fffffffffffffffffffffffffff........fff....fffff.ffff...................................fffffffff.....fffffffff..........................
        ...........................fffffffffffffffffff.............ffff...ffffffffff............................fff......ffffffffffffffffffff...........................
        ...............................ffffffff....................ffff...fffffffff.............................ffff.......ffffffffffffffff.............................
        ....................................fff....................ffffffffffffffff.............................fffff.........fffffffff.................................
        ....................................fff....................ffffffffff....................................fffff...........fff....................................
        ....................................fff....................ffffffffff.....................................fffff..........fff....................................
        ....................................fff....................ffff.fffff......................................fffff........ffff....................................
        ....................................fff...................ffff..............................................fffff.......ffff....................................
        ....................................fff...................ffff...............................................fffff......fff.....................................
        ....................................fff...................fff.................................................fffff....ffff.....................................
        ....................................fff..................ffff..................................................fffff...ffff.....................................
        ....................................fff..................ffff...................................................fffff..fff......................................
        ....................................fffffffffff..........fff.....................................................ffff.ffff......................................
        ....................................ffffffffffff.........fff......................................................ffffffff......................................
        ....................................fffffffffffff.......ffff......................................................ffffffffffffffffff............................
        ....................................fff......fffff......ffff.......................................................fffffffffffffffffffffffffffff................
        ....................................fff.......fffff.....fff.........................................................fffffffffffffffffffffffffffffffffff.........
        ....................................fff........fffff....fff..........................................................ffff.........ffffffffffffffffffffffff......
        ....................................fff.........fffff..ffff.........................................................ffff......................ffffffffffff......
        ....................................fff..........fffff.ffff.........................................................ffff.............................fffff......
        ....................................fff...........ffffffff..........................................................fff.........................................
        ....................................fff............fffffff.........................................................ffff.........................................
        ....................................fff.............fffff..........................................................ffff.........................................
        ....................................fff..............ffff..........................................................fff..........................................
        ....................................fff...........................................................................ffff..........................................
        ....................................fff...........................................................................ffff..........................................
        ....................................fff...........................................................................fff...........................................
        ....................................fff..........................................................................ffff...........................................
        ....................................fff..........................................................................ffff...........................................
        ....................................fff.........................................................................ffff............................................
        ....................................fff.........................................................................ffff............................................
        ....................................fff......................................................................ffffff.............................................
        ....................................fff.....................................................................fffffff.............................................
        ....................................fff...................................................................fffffffff.............................................
        ....................................fff..................................................................ffffff.fff.............................................
        ....................................fffff..............................................................fffffff..fff.............................................
        ....................................ffffff...........................................................fffffff....ffff............................................
        ....................................ffffff.......................................................ffffffffff.....ffff............................................
        ....................................fffffff..................................................ffffffffffff........fff............................................
        ...................................fffffffff...............................................ffffffffffff..........fff............................................
        ...................................ffff.ffff...............................................ffffffff..............fff............................................
        ..................................ffff...fff...............................................ffff..................ffff...........................................
        .................................fffff...ffff....................................................................ffff...........................................
        ................................fffff....ffff.....................................................................fff...........................................
        ................................ffff......ffff....................................................................fff...........................................
        ...............................ffff.......ffff....................................................................fff...........................................
        ..............................fffff........fff....................................................................fff...........................................
        .............................fffff.........ffff...................................................................fff...........................................
        ............................fffff..........ffff...................................................................ffff..........................................
        ............................ffff............ffff..................................................................ffff..........................................
        ...........................ffff.............ffff...................................................................fff..........................................
        ..........................fffff..............fff...................................................................fff..........................................
        .........................fffff...............fff...................................................................fff..........................................
        .........................ffff................fff...................................................................fff..........................................
        ........................ffff.................fff................................................................................................................
        .......................fffff.................ffff...............................................................................................................
        .......................ffff..................ffff...............................................................................................................
        .......................fff....................fff...............................................................................................................
        .....................fff......................fff...............................................................................................................
        .....................fff......................fff...............................................................................................................
        ....................ffff......................ffff..............................................................................................................
        ....................ffff......................ffff..............................................................................................................
`)
let hp_max = 100
hp = hp_max
let messenger = sprites.create(img`
        . . . . . . f f f f . . . . . . 
            . . . . f f f 2 2 f f f . . . . 
            . . . f f f 2 2 2 2 f f f . . . 
            . . f f f e e e e e e f f f . . 
            . . f f e 2 2 2 2 2 2 e e f . . 
            . . f e 2 f f f f f f 2 e f . . 
            . . f f f f e e e e f f f f . . 
            . f f e f b f 4 4 f b f e f f . 
            . f e e 4 1 f d d f 1 4 e e f . 
            . . f e e d d d d d d e e f . . 
            . . . f e e 4 4 4 4 e e f . . . 
            . . e 4 f 2 2 2 2 2 2 f 4 e . . 
            . . 4 d f 2 2 2 2 2 2 f d 4 . . 
            . . 4 4 f 4 4 5 5 4 4 f 4 4 . . 
            . . . . . f f f f f f . . . . . 
            . . . . . f f . . f f . . . . .
    `, SpriteKind.Player)
currentScene = "game"
controller.moveSprite(messenger)
scene.cameraFollowSprite(messenger)
statusbar = statusbars.create(20, 4, StatusBarKind.Health)
statusbar.attachToSprite(messenger)
//  barbed_wire
let wire = sprites.create(img`
        f f f f 1 f f f f 1 f f f f f f 
            f f f f 1 f f f f 1 f f 1 f f f 
            f f f f 1 f f f 1 f f f 1 f f f 
            f f f f 1 f f f 1 f f f 1 f f f 
            f f 1 1 f f f 1 1 f f 1 f f f f 
            f 1 f f f f f 1 f f f 1 f f f f 
            f f f f f f f f f f f 1 f f f f 
            f f f f f f f f f f f f f f f f
    `, SpriteKind.Enemy)
wire.setPosition(30, 30)
scaling.scaleToPixels(wire, randint(32, 64), ScaleDirection.Horizontally, ScaleAnchor.Middle)
for (let index = 0; index < randint(6, 11); index++) {
    spawn_landmine()
}
game.onUpdateInterval(randint(500, 1000), function on_update_interval() {
    
    leftBullet = sprites.create(img`
            . . . . . . . . 
                    . . . . . . . . 
                    . . . . . . . . 
                    . 5 f 5 5 5 . . 
                    . 5 f 5 5 5 5 . 
                    . 5 f 5 5 5 . . 
                    . . . . . . . . 
                    . . . . . . . .
        `, SpriteKind.Projectile)
    leftBullet.setPosition(0, randint(16, 496))
    leftBullet.setVelocity(randint(60, 130), 0)
    leftBullet.startEffect(effects.trail)
})
game.onUpdateInterval(randint(500, 1000), function on_update_interval2() {
    
    rightBullet = sprites.create(img`
            . . . . . . . . 
                    . . . . . . . . 
                    . . . . . . . . 
                    . . 5 5 5 f 5 . 
                    . 5 5 5 5 f 5 . 
                    . . 5 5 5 f 5 . 
                    . . . . . . . . 
                    . . . . . . . .
        `, SpriteKind.Projectile)
    rightBullet.setPosition(160, randint(16, 496))
    rightBullet.setVelocity(randint(-60, -130), 0)
    rightBullet.startEffect(effects.trail)
})
